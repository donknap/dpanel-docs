# 域名转发

容器对外访问时，可以通过暴露容器内部端口的形式进行。暴露端口时会将容器内的某个端口映射到宿主的端口上。
比如，Nginx 容器内部的访问端口为 80，可以将宿主机的 8080 映射到该容器的 80 端口上。那么可以通过 http://服务器ip:8080 进行访问该容器。

如果你需要使用【域名】的形式来访问某个容器，就需要利用 Nginx 之类的软件，通过反向代理的方式，将域名请求转发到某个容器中的某个端口。


### 标准版

> 在多环境中，只有安装了 dpanel 面板的 docker 服务环境支持域名转发功能

在 DPanel 标准版中，集成了 Nginx 与 Acme 软件，支持反向代理容器和申请免费 https 证书。
在安装时需要绑定容器的 80 及 443 端口。如果在创建面板时将 80、443 绑定到了其它端口上，那么访问域名时需求携带端口号。

``` shell
// 访问域名携带端口信息: http://test.com:880 或 https://test.com:8443

docker run -d --name dpanel ...(省略其它参数)... -p 880:80 -p 8443:443 dpanel/dpanel:latest
```

安装完成后，在【容器管理】中可以使用【域名转发】功能。

![domain-1.png](https://cdn.w7.cc/dpanel/domain-1.png)

### 反向代理

#### 转发到面板自身

给面板自身配置域名转发时，将【目标地址】配置为 127.0.0.1 【目标端口】配置为 8080 即可。

#### 转发到容器

当你通过【选择容器】功能添加转发容器后，面板会自动创建 dpanel-local 网络，并把转发目标容器与面板自身加入到该网络中。在转发配置中，则采用容器在 dpanel-local 网络中的 hostname 进行。

这样的好处是当你的目标容器 Ip 发生变化时也可以正常的转发。但是必须保证 dpanel 面板容器和目标容器在重建时必须添加至 dpanel-local 网络。

#### 通过自定义网络或是 bridge 网络

如果你的容器本身已经添加至某个自定义网络或是你想直接通过 bridge 网络进行转发，那么你在配置【转发目标】的时候可以直接指定容器在这自定义网络或是 bridge 网络中的 ip 或是 hostname。同样的道理，请保证 dpanel 面板也使终添加至该网络中。

#### 多环境下的转发

如果你添加了多个 docker 环境，那么仅在安装了 dpanel 面板的服务端可以使用域名转发功能。你也可以利用转发到 Ip + 端口的形式转发到其它 docker 服务端的容器。

在配置转发时可以通过【docker环境Ip:容器映射端口】来实现转发功能。比如：在 192.168.0.13 的主机上部署了某个容器并映射了 80 端口到主机的 8080，那么配置域名转发目标 ip 为 192.168.0.13:8080。

### 重定向

将某个域名重定向到目标域名或是 ip 上。