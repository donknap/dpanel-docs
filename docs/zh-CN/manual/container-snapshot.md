# 容器快照

容器快照功能可以一键备份某个容器的配置（运行参数）、存储数据以及镜像数据。
可以方便的对容器进行恢复和迁移操作。

## 生成快照

默认情况下，快照功能会将容器的配置以及全部存储目录（存储卷或是挂载目录）进行备份。备份文件存储在面板容器中的 /dpanel/backup 目录中。

![container-snapshot-1.png](https://we7cloud-10016060.cos.ap-shanghai.myqcloud.com/dpanel/container-snapshot-1.png?t=1)

## 选择备份目录

当容器中挂载多个目录或是存储卷时，你可以通过【选择备份目录】功能指定生成的快照中只包含哪些目录。

## 快照镜像

如果快照中不包含镜像数据，面板会在恢复快照时尝试从远程拉取镜像，此操作必须保证你的 docker 环境是可以正常拉取镜像。
如果拉取失败，你可以查看快照详情，手动先拉取镜像。

如果生成快照中勾选了【备份容器镜像】在恢复时，面板会先导入镜像，再创建容器。
此时，该容器使用的镜像为本地导入镜像，不能检测到远程是否有更新。

如果你修改过容器的非挂载目录数据，在快照时也可以通过【保存当前容器为镜像】先将容器提交为镜像再进行快照备份。
此时容器使用的镜像会通过【原始名称+备份日期】进行命名。

## 快照容器网络冲突

默认情况下，快照功能会将容器的网络信息也一同备份。在恢复时，可能会产生网络冲突的问题。
比如快照的容器使用的 test 网络子网是 172.18.0.0/16，在恢复时如果已经存在一个使用相同子网的网络，此时面板就无法创建快照中的网络。

你需要手动创建快照的网络或是将 test 网络删除掉。

## Docker 版本兼容

通过 docker version 命令查看。虽然面板最大程度上兼容了不同版本的差异，但是依然不可能做到 100% 兼容。
为了保证不必要的麻烦，尽量保证版本一致。

```
# 保证 Version 及 API version 版本一致。
# docker version

Client:
 Version:           27.0.3 
 API version:       1.46
```

## 导入快照

在 Pro 版，支持你手动将快照导入到当前 docker 环境中。